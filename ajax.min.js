!function(a){function b(a){var b=["GET","POST","PUT","HEAD","DELETE","OPTIONS","TRACE","CONNECT"],c=["JSON","URLENCODED"],d=function(){var a=document.getElementsByName("csrf-token")[0];return"undefined"!==a&&null!=a?a.content:null},e=function(){};if(this.method=a.method||"GET",this.url=a.url,this.data=a.data||{},this.token=a.token||d(),this.onSuccess=a.onSuccess||e,this.onError=a.onError||e,this.onStart=a.onStart||e,this.onFinish=a.onFinish||e,this.onTimeout=a.onTimeout||e,this.timeout=a.timeout||0,this.type=a.type||"URLENCODED","undefined"==typeof a.url)throw"Ajax requires a url.";if(-1===b.indexOf(this.method))throw"Ajax method must be valid.";if(-1===c.indexOf(this.type))throw"Ajax content type must be valid.";return this}var c={JSON:"application/json",URLENCODED:"application/x-www-form-urlencoded"},d=function(a){return c[a.type]},e=function(a){var b=new XMLHttpRequest;return"withCredentials"in b?b.open(a.method,a.url,!0):"undefined"!=typeof XDomainRequest&&(b=new XDomainRequest,b.open(a.method,a.url)),b.timeout=a.timeout,b.setRequestHeader("Content-type",d(a)),a.token&&b.setRequestHeader("X-CSRF-Token",a.token),b},f=function(a,b){b.addEventListener("timeout",a.onTimeout(b),!1),a.onStart(b),b.addEventListener("readystatechange",function(){4===this.readyState&&(200===this.status?a.onSuccess(this):a.onError(this),a.onFinish(this))},!1)},g=function(a){if("JSON"===a.type)return JSON.stringify(a.data);var b=[];for(var c in a.data){var d=a.data[c];b.push(c+"="+encodeURIComponent(d))}return b.join("&")};b.request=function(a){return new this(a).send()},b.prototype.send=function(){return xhr=e(this),f(this,xhr),xhr.send(g(this)),this},"function"==typeof define&&define.amd?define("ajax",[],function(){return b}):a.Ajax=b}(this);